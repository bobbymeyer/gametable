<div class="mx-auto max-w-7xl px-4 py-8 text-left">
  <%= link_to @series.name, @series, class: "text-sm text-stone-600 dark:text-stone-400 hover:text-stone-800 dark:hover:text-stone-300" %>
  <h1 class="text-3xl font-bold text-stone-900 dark:text-white mt-2"><%= @character.name %></h1>

  <div class="mt-6 flex flex-wrap items-start gap-8">
    <% if @character.portrait.attached? %>
      <div class="flex-shrink-0">
        <%= image_tag @character.portrait, alt: "Portrait of #{@character.name}", class: "rounded-lg border border-stone-200 dark:border-stone-700 max-w-[200px] h-auto" %>
      </div>
    <% end %>
    <div class="min-w-0">
      <p class="text-stone-600 dark:text-stone-400">XP: <%= @character.xp %></p>

      <% if @series.producer?(current_user) %>
        <div class="mt-6 rounded-lg border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-900/50 p-4">
          <h2 class="text-sm font-semibold text-stone-900 dark:text-white mb-2">Generate portrait (Comfy)</h2>
          <p class="text-sm text-stone-600 dark:text-stone-400 mb-3">Create a small portrait of this character using ComfyUI. Leave the prompt blank to use a default, or describe the image you want.</p>
          <%= form_with url: generate_portrait_character_path(@character), method: :post, local: true, class: "flex flex-wrap items-end gap-2" do |f| %>
            <div class="min-w-[240px] flex-1">
              <label for="prompt" class="block text-xs font-medium text-stone-500 dark:text-stone-400 mb-1">Prompt (optional)</label>
              <input type="text" name="prompt" id="prompt" placeholder="e.g. small portrait, head and shoulders, oil painting" value="" class="w-full border border-stone-300 dark:border-stone-600 bg-white dark:bg-stone-900 text-stone-900 dark:text-stone-100 px-3 py-2 rounded text-sm" />
            </div>
            <button type="submit" class="bg-amber-500 px-4 py-2 text-sm font-semibold text-stone-950 hover:bg-amber-400 transition-colors rounded">Generate portrait</button>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
